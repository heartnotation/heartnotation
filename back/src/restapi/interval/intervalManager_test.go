package interval

import (
	"restapi/utils"
	u "restapi/utils"
	"strings"
	"testing"
)

func TestGetIntervalsCommentMethod(t *testing.T) {
	utils.CheckMethod("GET", u.CheckRoutes["intervalscomment"], GetIntervalComment, t)
}

func TestGetIntervalsCommentPath(t *testing.T) {
	utils.CheckPath("GET", u.CheckRoutes["intervalscomment"], GetIntervalComment, t)
}

func TestReadGetIntervalsComment(t *testing.T) {
	if strings.TrimSpace(utils.ReadTest("http://localhost:8000/intervals/comment")) != `[{"id":1,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":1,"interval":{"id":1,"start":3,"end":4,"is_active":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"HOLLY","date":"2004-10-19T10:23:54Z"},{"id":2,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":2,"interval":{"id":2,"start":7,"end":9,"is_active":true,"tags":[{"id":2,"name":"Lungs on water","color":"blue","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"MOLLY","date":"2004-10-19T10:23:54Z"},{"id":3,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":3,"interval":{"id":3,"start":11,"end":29,"is_active":true,"tags":[{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"gOdsAkE","date":"2004-10-19T10:23:54Z"}]` {
		t.Error("Expected content", `[{"id":1,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":1,"interval":{"id":1,"start":3,"end":4,"is_active":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"HOLLY","date":"2004-10-19T10:23:54Z"},{"id":2,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":2,"interval":{"id":2,"start":7,"end":9,"is_active":true,"tags":[{"id":2,"name":"Lungs on water","color":"blue","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"MOLLY","date":"2004-10-19T10:23:54Z"},{"id":3,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":3,"interval":{"id":3,"start":11,"end":29,"is_active":true,"tags":[{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"gOdsAkE","date":"2004-10-19T10:23:54Z"}]`)
	}
}

func TestGetIntervalsTagMethod(t *testing.T) {
	utils.CheckMethod("GET", u.CheckRoutes["intervalstag"], GetIntervalTag, t)
}

func TestGetIntervalsTagPath(t *testing.T) {
	utils.CheckPath("GET", u.CheckRoutes["intervalstag"], GetIntervalTag, t)
}

func TestReadGetIntervalsTag(t *testing.T) {
	if strings.TrimSpace(utils.ReadTest("http://localhost:8000/intervals/tag")) != `[{"id":1,"start":3,"end":4,"is_active":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true}]},{"id":2,"start":7,"end":9,"is_active":true,"tags":[{"id":2,"name":"Lungs on water","color":"blue","is_active":true}]},{"id":3,"start":11,"end":29,"is_active":true,"tags":[{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]}]` {
		t.Error("Expected content", `[{"id":1,"start":3,"end":4,"is_active":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true}]},{"id":2,"start":7,"end":9,"is_active":true,"tags":[{"id":2,"name":"Lungs on water","color":"blue","is_active":true}]},{"id":3,"start":11,"end":29,"is_active":true,"tags":[{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]}]`)
	}
}

func TestGetIntervalsMethod(t *testing.T) {
	utils.CheckMethod("GET", u.CheckRoutes["intervals"], GetInterval, t)
}

func TestGetIntervalsPath(t *testing.T) {
	utils.CheckPath("GET", u.CheckRoutes["intervals"], GetInterval, t)
}

func TestReadIntervals(t *testing.T) {
	if strings.TrimSpace(utils.ReadTest("http://localhost:8000/intervals")) != `[{"id":1,"start":3,"end":4,"is_active":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}],"comments":{"id":1,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":1,"interval":{"id":1,"start":3,"end":4,"is_active":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"HOLLY","date":"2004-10-19T10:23:54Z"}},{"id":2,"start":7,"end":9,"is_active":true,"comments":{"id":2,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":2,"interval":{"id":2,"start":7,"end":9,"is_active":true,"tags":[{"id":2,"name":"Lungs on water","color":"blue","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"MOLLY","date":"2004-10-19T10:23:54Z"}},{"id":3,"start":11,"end":29,"is_active":true,"comments":{"id":3,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":3,"interval":{"id":3,"start":11,"end":29,"is_active":true,"tags":[{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"gOdsAkE","date":"2004-10-19T10:23:54Z"}}]` {
		t.Error("Expected content", `[{"id":1,"start":3,"end":4,"is_active":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}],"comments":{"id":1,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":1,"interval":{"id":1,"start":3,"end":4,"is_active":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"HOLLY","date":"2004-10-19T10:23:54Z"}},{"id":2,"start":7,"end":9,"is_active":true,"comments":{"id":2,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":2,"interval":{"id":2,"start":7,"end":9,"is_active":true,"tags":[{"id":2,"name":"Lungs on water","color":"blue","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"MOLLY","date":"2004-10-19T10:23:54Z"}},{"id":3,"start":11,"end":29,"is_active":true,"comments":{"id":3,"annotation_id":1,"annotation":{"id":1,"name":"Annotation 1","organization":{"id":1,"name":"Cardiologs","is_active":true},"organization_id":1,"status":{"id":1,"name":"CREATED","is_active":true},"status_id":1,"signal_id":1,"creation_date":"2004-10-19T10:23:54Z","edit_date":"2012-12-29T17:19:54Z","is_active":true,"is_editable":true,"tags":[{"id":1,"name":"Lungs on fire","color":"red","is_active":true},{"id":2,"name":"Lungs on water","color":"blue","is_active":true},{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"interval_id":3,"interval":{"id":3,"start":11,"end":29,"is_active":true,"tags":[{"id":3,"parent_id":2,"name":"Weird lungs","color":"green","is_active":true}]},"user_id":1,"user":{"id":1,"mail":"rolex@gmail.com","role":{"id":3,"name":"Admin","is_active":true},"role_id":3,"organizations":[{"id":2,"name":"Podologs","is_active":true}],"is_active":true},"comment":"gOdsAkE","date":"2004-10-19T10:23:54Z"}}]`)
	}
}
